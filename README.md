#Buruki.ru affiliate API

##Общие положения:

 - текущая версия API располагается по адресу [http://buruki.ru/api/affiliate/](http://buruki.ru/api/affiliate/)
 - метод запроса (GET или POST) не имеет значения.
 - в результате вызова возвращается JSON.
 - для защищенных методов (указано в описании метода) требуется apikey, как его получить см. ниже

**Получение apikey:**
 - зарегистрируйтесь на http://buruki.ru/affiliate
 - свяжитесь с нами, мы сгенерируем токен и он будет доступен в вашем профиле - http://buruki.ru/affiliate/affiliate_profile/

На данный момент все токены "вечные", но могут быть отозваны администрацией.

В случае удачного выполнения запроса результат выглядит следующим образом:
```
{'response': ... }
```
В `response` содержится результат вызова.

В случае ошибки при запросе результат выглядит следующим образом:
```
{'error': {'code': 10, 'message': 'some msg'}}
```

Коды ошибок:
 - -1 (минус один) - внутренняя ошибка
 - 10 - недостаточно прав для запроса.
 - 20 - передано неправильное имя пользователя или токен.
 - 30 - аргументы метода некорректны.

##stats
Метод требует корректного apikey при вызове.

Возвращает информацию о продажах реферера за указанный период.

```
http://buruki.ru/api/affiliate/stats?username=username&apikey=6a069b9f4070213007ca8e2c23edfd9e&date_start=2013-08-01
```

параметры:

`username` - имя пользователя при регистрации на http://buruki.ru/affiliate (обязательный параметр).

`apikey` - ключ доступа. Выдаётся по запросу (обязательный параметр).

`date_start` и `date_end` - фильтрация по датам продаж. Формат `YYYY-MM-DD`, пример - `2013-01-01`.

```
{'response': [{
  status: "P",
  created: "2013-08-19T10:47",
  dst: "VKO",
  label: "136123",
  org: "ULV",
  com: 120,
  id: 31573
}, ...]}
``` 

 - `status`: статус продажи. B (билет забронирован), C (отменён), P (оплачен), R (возвращён).
 - `created`: дата и время продажи.
 - `org`, `dst`: IATA-коды аэропортов вылета и назначения соответственно.
 - `label`: значение GET-параметра `label`, который был передан при переходе от партнёра.
 - `com`: комиссия в рублях.
 - `id`: идентификатор продажи.
